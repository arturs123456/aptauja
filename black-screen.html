<!DOCTYPE html>
<html lang="lv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Black Screen</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&display=swap');

        * { box-sizing: border-box; margin: 0; padding: 0; }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
            cursor: none;
        }

        #screen {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            cursor: none;
            position: relative;
        }

        #text-display {
            font-family: 'Montserrat', Arial, Helvetica, sans-serif;
            font-weight: 900;
            font-size: clamp(40px, 7vw, 120px);
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            text-align: center;
            line-height: 1.15;
            user-select: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* Cursor - vertical blinking line */
        #cursor {
            display: inline-block;
            width: 3px;
            height: 0.85em;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 2px;
            animation: blink 1.2s ease-in-out infinite;
        }

        #cursor.hidden {
            display: none;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            40% { opacity: 1; }
            50% { opacity: 0; }
            90% { opacity: 0; }
        }

        /* Text lines */
        .text-line {
            display: block;
            overflow: hidden;
        }

        /* Each word animates in */
        .word {
            display: inline-block;
            animation: wordIn 0.35s cubic-bezier(0.16, 1, 0.3, 1) both;
        }

        @keyframes wordIn {
            0% {
                opacity: 0;
                transform: translateY(12px) scale(0.92);
                filter: blur(6px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }

        /* Smooth layout transitions */
        #text-display {
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* Fullscreen button */
        #fs-btn {
            position: fixed;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: rgba(255, 255, 255, 0.4);
            font-family: 'Montserrat', sans-serif;
            font-size: 12px;
            font-weight: 700;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 10;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        body:hover #fs-btn {
            opacity: 1;
        }

        #fs-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            color: rgba(255, 255, 255, 0.7);
        }
    </style>
</head>
<body>
    <div id="screen">
        <button id="fs-btn" title="Fullscreen (F)">Fullscreen</button>
        <div id="text-display">
            <span id="cursor"></span>
        </div>
    </div>

    <script>
        const textDisplay = document.getElementById('text-display');
        const cursorEl = document.getElementById('cursor');
        const screen = document.getElementById('screen');
        const fsBtn = document.getElementById('fs-btn');
        let text = '';
        let prevWordCount = 0;

        // --- Keyboard click sound (Web Audio API) ---
        let audioCtx = null;
        function getAudioCtx() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            return audioCtx;
        }

        function playKeyClick() {
            const ctx = getAudioCtx();
            const t = ctx.currentTime;

            // Short noise burst — the "click"
            const bufferLen = Math.floor(ctx.sampleRate * 0.012); // 12ms
            const buffer = ctx.createBuffer(1, bufferLen, ctx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferLen; i++) {
                // Shaped noise: fast attack, quick decay
                const env = Math.exp(-i / (bufferLen * 0.18));
                data[i] = (Math.random() * 2 - 1) * env;
            }
            const noise = ctx.createBufferSource();
            noise.buffer = buffer;

            // Bandpass filter — gives it that plastic key character
            const filter = ctx.createBiquadFilter();
            filter.type = 'bandpass';
            filter.frequency.value = 3800;
            filter.Q.value = 1.2;

            // Very quiet gain
            const gain = ctx.createGain();
            gain.gain.setValueAtTime(0.07, t);
            gain.gain.exponentialRampToValueAtTime(0.001, t + 0.015);

            noise.connect(filter);
            filter.connect(gain);
            gain.connect(ctx.destination);
            noise.start(t);
            noise.stop(t + 0.015);
        }

        // Split words into lines: line1 = 2 words, line2 = 3 words, line3 = rest
        function splitIntoLines(words) {
            if (words.length === 0) return [];
            if (words.length <= 2) return [words];
            if (words.length <= 5) return [words.slice(0, 2), words.slice(2)];
            return [words.slice(0, 2), words.slice(2, 5), words.slice(5)];
        }

        function render() {
            const trimmed = text.trim();
            const words = trimmed ? trimmed.split(/\s+/) : [];
            const currentWordCount = words.length;
            const hasPartialWord = text.length > 0 && text[text.length - 1] !== ' ';

            // If no text, show only the blinking cursor
            if (words.length === 0 && text.length === 0) {
                textDisplay.innerHTML = '';
                const c = document.createElement('span');
                c.id = 'cursor';
                textDisplay.appendChild(c);
                prevWordCount = 0;
                return;
            }

            // Include partial text (current word being typed)
            const allTokens = text.toUpperCase().trim().split(/\s+/).filter(Boolean);
            const lines = splitIntoLines(allTokens);

            // Build HTML
            let html = '';
            let wordIndex = 0;

            for (let i = 0; i < lines.length; i++) {
                html += '<div class="text-line">';
                for (let j = 0; j < lines[i].length; j++) {
                    const isNewWord = wordIndex >= prevWordCount;
                    const isLastWord = (i === lines.length - 1 && j === lines[i].length - 1);
                    const space = j < lines[i].length - 1 ? ' ' : '';

                    if (isNewWord) {
                        html += '<span class="word" style="animation-delay: ' + (j * 0.04) + 's">' + escapeHtml(lines[i][j]) + '</span>' + space;
                    } else {
                        html += '<span class="word" style="animation: none;">' + escapeHtml(lines[i][j]) + '</span>' + space;
                    }
                    wordIndex++;
                }
                html += '</div>';
            }

            textDisplay.innerHTML = html;

            // Cursor is hidden when there is text
            // (no cursor element added)

            prevWordCount = currentWordCount;
        }

        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        document.addEventListener('keydown', function(e) {
            // F or F11 for fullscreen
            if (e.key === 'F11' || (e.key === 'f' && text.length === 0 && !e.ctrlKey && !e.metaKey)) {
                e.preventDefault();
                toggleFullscreen();
                return;
            }

            // Escape - let browser handle fullscreen exit
            if (e.key === 'Escape') return;

            // Ctrl/Cmd+Backspace - delete all
            if ((e.ctrlKey || e.metaKey) && e.key === 'Backspace') {
                e.preventDefault();
                playKeyClick();
                text = '';
                prevWordCount = 0;
                render();
                return;
            }

            // Backspace - delete character
            if (e.key === 'Backspace') {
                e.preventDefault();
                playKeyClick();
                if (text.length > 0) {
                    // Check if we're removing a word boundary
                    const hadWords = text.trim().split(/\s+/).filter(Boolean).length;
                    text = text.slice(0, -1);
                    const hasWords = text.trim().split(/\s+/).filter(Boolean).length;
                    if (hasWords < hadWords) {
                        prevWordCount = Math.max(0, hasWords);
                    }
                }
                render();
                return;
            }

            // Ignore modifier keys and special keys
            if (e.ctrlKey || e.metaKey || e.altKey) return;
            if (e.key.length !== 1) return;

            // Limit to 50 chars
            if (text.length >= 50) return;

            // Prevent double spaces
            if (e.key === ' ' && (text.length === 0 || text[text.length - 1] === ' ')) return;

            playKeyClick();
            text += e.key;
            render();
        });

        // Click to ensure focus
        screen.addEventListener('click', function(e) {
            if (e.target === fsBtn) return;
            screen.focus();
        });

        // Fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(function() {});
            } else {
                document.exitFullscreen().catch(function() {});
            }
        }

        fsBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            toggleFullscreen();
        });

        document.addEventListener('fullscreenchange', function() {
            fsBtn.textContent = document.fullscreenElement ? 'Exit' : 'Fullscreen';
        });

        // Initial render - show blinking cursor
        render();
    </script>
</body>
</html>
